class SqlcGoOneOrFail < Formula
  desc 'modify the code generated by sqlc to fail if more than one record is retrieved in the `:one` command.'
  version '0.0.2'
  homepage 'https://github.com/k1LoW/sqlc-go-one-or-fail'

  on_macos do
    if Hardware::CPU.arm?
      url 'https://github.com/k1LoW/sqlc-go-one-or-fail/releases/download/v0.0.2/sqlc-go-one-or-fail_v0.0.2_darwin_arm64.zip'
      sha256 '8e9713f471b46a8c2ad67abe9b6e2bd9ddc6d0f17ab29b1249e71d0045a9d38b'
    end
    if Hardware::CPU.intel?
      url 'https://github.com/k1LoW/sqlc-go-one-or-fail/releases/download/v0.0.2/sqlc-go-one-or-fail_v0.0.2_darwin_amd64.zip'
      sha256 '070792ca7bc5983f544ef774357044013a14f2c9aab4e384655797c35cb29d36'
    end
  end

  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url 'https://github.com/k1LoW/sqlc-go-one-or-fail/releases/download/v0.0.2/sqlc-go-one-or-fail_v0.0.2_linux_arm64.tar.gz'
      sha256 'b0e3f7c346587f5866a000257ca499856e18c538123f8e77021587c01c85779c'
    end
    if Hardware::CPU.intel?
      url 'https://github.com/k1LoW/sqlc-go-one-or-fail/releases/download/v0.0.2/sqlc-go-one-or-fail_v0.0.2_linux_amd64.tar.gz'
      sha256 '20f55e7e9dcbf58879eef08a152200456f036da75740c8aeeb9da3431c553fd1'
    end
  end

  head do
    url 'https://github.com/k1LoW/sqlc-go-one-or-fail.git'
    depends_on 'go' => :build
  end

  def install
    system 'make', 'build' if build.head?
    bin.install 'sqlc-go-one-or-fail'
    generate_completions_from_executable(bin/'sqlc-go-one-or-fail', 'completion')
  end
end
